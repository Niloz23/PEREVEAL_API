# Виртуальная стажировка
## Pereval Rest API

Федерация спортивного туризма России (ФСТР) заказала студентам SkillFactory разработать мобильное приложение для Android и iOS, которое упростит туристам отправку данных о перевале и сократит время обработки запроса до трёх дней.

### Описание проекта

Мобильное приложение предназначено для туристов, которые смогут в горах вносить данные о перевале и отправлять их в ФСТР, как только появится доступ в Интернет. Модераторы ФСТР будут верифицировать информацию и вносить её в базу данных. Туристы смогут отслеживать статус модерации своих заявок и просматривать информацию, внесённую другими пользователями.

### Данные, которые турист передает через приложение:
- Фамилия
- Имя
- Отчество
- Электронная почта
- Номер телефона
- Название объекта
- Координаты объекта и его высота
- Уровень сложности в зависимости от времени года
- Несколько фотографий

### Методы API

#### 1. `POST /Pereval/`
Принимает JSON с информацией о перевале.  
Пример JSON:

```json
{
  "beauty_title": "пер. ",
  "title": "Пхия",
  "other_titles": "Триев",
  "connect": "",
  "user": {
    "email": "qwerty@mail.ru",
    "fam": "Пупкин",
    "name": "Василий",
    "otc": "Иванович",
    "phone": "+7 555 55 55"
  },
  "coords": {
    "latitude": "45.3842",
    "longitude": "7.1525",
    "height": "1200"
  },
  "level": {
    "winter": "",
    "summer": "1А",
    "autumn": "1А",
    "spring": ""
  },
  "images": [
    { "data": "<картинка1>", "title": "Седловина" },
    { "data": "<картинка2>", "title": "Подъём" }
  ]
```
Примеры oтветов:

```json
{ "status": 500, "message": "Ошибка подключения к базе данных","id": null}
```
```json
{ "status": 200, "message": null, "id": 42 }
```
После того, как турист добавит в базу данных информацию о новом перевале, сотрудники ФСТР проведут модерацию для каждого нового объекта и поменяют поле `status`.

### Допустимые значения поля `status`:
- `new`
- `pending` — модератор взял в работу
- `accepted` — модерация прошла успешно
- `rejected` — модерация прошла, информация не принята

### Методы API

#### 1. `GET /Pereval/`
Получает одну запись (перевал) по её `id`, включая всю информацию об перевале, в том числе статус модерации.

#### 2. `PATCH /Pereval/`
Позволяет отредактировать существующую запись (замена) при условии, что она находится в статусе `new`. Редактировать можно все поля, кроме тех, что содержат ФИО, адрес электронной почты и номер телефона.  

##### Ответ:
- `state: 1` — если запись успешно отредактирована
- `state: 0` — если редактирование не удалось
- `message` — сообщение о причине неудачного обновления

#### 3. `GET /Pereval/?user_id__email=`
Позволяет получить данные всех объектов, отправленных на сервер пользователем с указанной электронной почтой. Реализована фильтрация по адресу электронной почты пользователя с использованием пакета `django-filter`.

